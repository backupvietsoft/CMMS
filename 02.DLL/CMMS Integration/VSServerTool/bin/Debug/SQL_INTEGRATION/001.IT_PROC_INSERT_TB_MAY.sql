CREATE PROC [dbo].[IT_PROC_INSERT_TB_MAY]
	@MS_MAY nvarchar(30),
	@TEN_MAY nvarchar(255),
	@MO_TA nvarchar(255),
	@NHIEM_VU_THIET_BI nvarchar(150)
	--@INSERT_DATE datetime ,
	--@UPDATE_DATE datetime 
AS


IF EXISTS(SELECT * FROM TB_MAY WHERE MS_MAY = @MS_MAY)
	BEGIN
	
	INSERT INTO TB_MAY(MS_MAY, TEN_MAY,MO_TA, NHIEM_VU_THIET_BI,UPDATE_DATE,DA_CHUYEN)
	VALUES ( @MS_MAY , @TEN_MAY,@MO_TA,@NHIEM_VU_THIET_BI,GETDATE(),CONVERT(BIT,0))
	--SELECT MS_MAY, TEN_MAY,MO_TA, NHIEM_VU_THIET_BI,INSERT_DATE,DA_CHUYEN 
	--FROM TB_MAY 
	--WHERE MS_MAY = @MS_MAY AND (TEN_MAY <> @MS_MAY OR MO_TA <>@MO_TA OR NHIEM_VU_THIET_BI <> @NHIEM_VU_THIET_BI ) 
	
	END
ELSE
BEGIN
	INSERT INTO TB_MAY(MS_MAY, TEN_MAY,MO_TA, NHIEM_VU_THIET_BI,INSERT_DATE,DA_CHUYEN)
	VALUES ( @MS_MAY , @TEN_MAY,@MO_TA,@NHIEM_VU_THIET_BI,GETDATE(),CONVERT(BIT,0))

END
