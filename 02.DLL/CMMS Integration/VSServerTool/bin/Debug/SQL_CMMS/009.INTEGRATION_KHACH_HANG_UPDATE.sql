CREATE PROC [dbo].[INTEGRATION_KHACH_HANG_UPDATE]
	@STT int ,
	@MS_KH nvarchar(30),
	@TEN_CONG_TY nvarchar(255) ,
	@TEN_RUT_GON nvarchar(255) ,
	@DIA_CHI nvarchar(100) ,
	@TEL NVARCHAR(30) ,
	@FAX NVARCHAR(30) ,
	@TEN_NDD NVARCHAR(100) ,
	@EMAIL NVARCHAR(100) ,
	@QUOCGIA NVARCHAR(255) ,
	@TAI_KHOAN_ANH NVARCHAR(255) ,
	@MS_THUE NVARCHAR(255) ,
	@TEN_NLH NVARCHAR(255) ,
	@CHUC_VU NVARCHAR(255) ,
	@DI_DONG NVARCHAR(255) ,
	@TEL_LH NVARCHAR(255) ,
	@HOME_TEL NVARCHAR(255) ,
	@EMAIL_LH NVARCHAR(255) ,
	@GHI_CHU NVARCHAR(255) ,
	@HOME_ADD NVARCHAR(255) ,
	@INSERT_DATE NVARCHAR(30) ,
	@UPDATE_DATE NVARCHAR(30) ,
	@DA_CHUYEN BIT ,
	@NGAY_CHUYEN NVARCHAR(30)
AS


Declare @MA_QG nvarchar(30)
SELECT @MA_QG = MA_QG FROM IC_QUOC_GIA WHERE MA_QG = @QUOCGIA

IF EXISTS ( SELECT MS_KH FROM KHACH_HANG WHERE MS_KH = @MS_KH)
	BEGIN
		UPDATE KHACH_HANG SET TEN_CONG_TY = @TEN_CONG_TY, TEN_RUT_GON = @TEN_RUT_GON, DIA_CHI = @DIA_CHI,
		 TEL = @TEL, FAX = @FAX, TEN_NDD = @TEN_NDD, EMAIL = @EMAIL, QUOCGIA = @MA_QG,
		 TAI_KHOAN_ANH = @TAI_KHOAN_ANH, MS_THUE = @MS_THUE
		WHERE MS_KH = @MS_KH 
	
	END
	ELSE
	BEGIN
		INSERT INTO KHACH_HANG(MS_KH, TEN_CONG_TY, TEN_RUT_GON, DIA_CHI, TEL, FAX, TEN_NDD, EMAIL, QUOCGIA, TAI_KHOAN_ANH, MS_THUE)
		VALUES( @MS_KH, @TEN_CONG_TY, @TEN_RUT_GON, @DIA_CHI, @TEL, @FAX, @TEN_NDD, @EMAIL, @MA_QG, @TAI_KHOAN_ANH, @MS_THUE)
	END	
	
	
