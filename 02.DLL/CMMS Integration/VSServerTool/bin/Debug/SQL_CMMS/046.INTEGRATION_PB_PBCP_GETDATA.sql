CREATE PROC dbo.[INTEGRATION_PB_PBCP_GETDATA]
	 @MS_BP_CHIU_PHI INT ,
	 @MS_KHO INT,
	 @FROMDATE DATETIME,
	 @TODATE DATETIME
AS

--DECLARE @MS_BP_CHIU_PHI INT 
--DECLARE @MS_KHO INT
--DECLARE @FROMDATE DATETIME
--DECLARE @TODATE DATETIME

SELECT MS_DH_XUAT_PT , IC_DON_HANG_XUAT.MS_BP_CHIU_PHI , BO_PHAN_CHIU_PHI.TEN_BP_CHIU_PHI , NGAY , IC_DON_HANG_XUAT.MS_KHO , IC_KHO.TEN_KHO
FROM IC_DON_HANG_XUAT INNER JOIN BO_PHAN_CHIU_PHI ON IC_DON_HANG_XUAT.MS_BP_CHIU_PHI = BO_PHAN_CHIU_PHI.MS_BP_CHIU_PHI
INNER JOIN IC_KHO ON IC_DON_HANG_XUAT.MS_KHO = IC_KHO.MS_KHO
WHERE (@MS_BP_CHIU_PHI = -1 OR IC_DON_HANG_XUAT.MS_BP_CHIU_PHI = @MS_BP_CHIU_PHI) 
AND (@MS_KHO = -1 OR IC_DON_HANG_XUAT.MS_KHO = @MS_KHO )
AND (CONVERT(DATETIME,IC_DON_HANG_XUAT.NGAY,112) >= @FROMDATE AND CONVERT(DATETIME,IC_DON_HANG_XUAT.NGAY,112) <= @TODATE)