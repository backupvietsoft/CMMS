IF NOT EXISTS (SELECT * FROM sys.objects WHERE type = 'P' AND name = 'INTEGRATION_HANG_SAN_XUAT_UPDATE')
   exec('CREATE PROCEDURE [dbo].[INTEGRATION_HANG_SAN_XUAT_UPDATE] AS BEGIN SET NOCOUNT ON; END')
GO

ALTER PROC [dbo].[INTEGRATION_HANG_SAN_XUAT_UPDATE]
	@MS_HSX int,
	@MS_HSX_CU int,
	@TEN_HSX nvarchar(50),
	@STATUS nvarchar(1)
AS



IF @STATUS = 'N'
BEGIN
	

	IF EXISTS ( SELECT MS_HSX FROM HANG_SAN_XUAT WHERE MS_HSX = @MS_HSX)
	BEGIN
		UPDATE HANG_SAN_XUAT SET TEN_HSX = @TEN_HSX
		WHERE MS_HSX = @MS_HSX 
	END
	ELSE
	BEGIN
	
	Set IDENTITY_INSERT HANG_SAN_XUAT ON
	
		INSERT INTO HANG_SAN_XUAT(MS_HSX, TEN_HSX)
		VALUES( @MS_HSX, @TEN_HSX)
		
	SET IDENTITY_INSERT HANG_SAN_XUAT OFF
			
	END	
END
	
IF @STATUS = 'E'
BEGIN

	
	
	IF @MS_HSX = @MS_HSX_CU
	BEGIN 
		UPDATE HANG_SAN_XUAT SET TEN_HSX = @TEN_HSX WHERE MS_HSX = @MS_HSX 
	END
	ELSE
	BEGIN 
		EXEC spCapNhapMaHangSanXuat @MS_HSX_CU,@MS_HSX
		
		UPDATE HANG_SAN_XUAT SET TEN_HSX = @TEN_HSX WHERE MS_HSX = @MS_HSX 
	END

END	

IF @STATUS = 'D'
BEGIN
	DELETE HANG_SAN_XUAT WHERE MS_HSX = @MS_HSX 
END