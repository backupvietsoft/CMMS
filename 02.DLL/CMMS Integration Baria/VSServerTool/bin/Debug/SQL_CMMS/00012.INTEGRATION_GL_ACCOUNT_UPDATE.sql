IF NOT EXISTS (SELECT * FROM sys.objects WHERE type = 'P' AND name = 'INTEGRATION_GL_ACOUNT_UPDATE')
   exec('CREATE PROCEDURE [dbo].[INTEGRATION_GL_ACOUNT_UPDATE] AS BEGIN SET NOCOUNT ON; END')
GO

ALTER PROC [dbo].[INTEGRATION_GL_ACOUNT_UPDATE]	
	@MS_GL nvarchar(20),
	@TEN_GL nvarchar(250),
	@MS_CHA nvarchar(20),
	@STATUS nvarchar(1)
AS

IF @STATUS = 'N'
BEGIN
	IF EXISTS (SELECT MS_GL FROM GL_ACOUNT WHERE MS_GL = @MS_GL)
	BEGIN
		UPDATE GL_ACOUNT SET TEN_GL = @TEN_GL, MS_CHA = @MS_CHA WHERE MS_GL = @MS_GL 
	END
	ELSE
	BEGIN
		INSERT INTO GL_ACOUNT (MS_GL, TEN_GL,MS_CHA)
		VALUES( @MS_GL, @TEN_GL, @MS_CHA)
	END	
END

IF @STATUS = 'E'
BEGIN
	UPDATE GL_ACOUNT SET TEN_GL = @TEN_GL, MS_CHA = @MS_CHA WHERE MS_GL = @MS_GL 
END	

IF @STATUS = 'D'
BEGIN
	DELETE GL_ACOUNT WHERE MS_GL = @MS_GL 
END	

